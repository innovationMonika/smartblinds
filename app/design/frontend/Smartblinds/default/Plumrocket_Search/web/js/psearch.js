define(["jquery","domReady!"],function(t){"use strict";function l(f){var i=this,e=t("#pas-mini-form"),c=t("#pas-tooltip"),s=t(".pas-overley");this.config={path:"",delay:500,queryLenghtMin:2,formSelector:"",tooltipSelector:"",overleySelector:""},t.extend(this.config,f),this.config.formSelector&&(e=t(this.config.formSelector)),this.config.tooltipSelector&&(c=t(this.config.tooltipSelector)),this.config.overleySelector&&(s=t(this.config.overleySelector)),this.timeout=null,this.run=function(){e.on("change",".pas-nav-left .pas-search-dropdown",function(){var o=t.trim(t(this).find("option:selected").text());e.find(".pas-nav-left .pas-search-label").text(o)}),e.find(".pas-nav-center .pas-input-text").on("keyup",function(){var o=this.value,a=e.find(".pas-nav-left .pas-search-dropdown").val();this.timeout&&clearTimeout(this.timeout),o.length>=i.config.queryLenghtMin?this.timeout=setTimeout(function(){i._find(o,a)},i.config.delay):i._hide()}).on("blur",function(){setTimeout(function(){i._hide()},500)})},this._find=function(o,a){e.find(".pas-loader").css("visibility","visible"),t.post(i.config.path,{q:o,cat:a},function(n){n=JSON.parse(t.trim(n)),n.q==e.find(".pas-nav-center .pas-input-text").val()&&(n.success&&n.content?(c.html(n.content),i._show()):i._hide())}).always(function(){e.find(".pas-loader").css("visibility","hidden")}).fail(function(){})},this._show=function(){e.addClass("pas-active"),s.addClass("show")},this._hide=function(){e.removeClass("pas-active"),s.removeClass("show")}}return l});
