define(["jquery","domReady!"],function(i){"use strict";function l(f){var e=this,t=i("#pas-mini-form"),c=i("#pas-tooltip"),s=i(".pas-overley");this.config={path:"",delay:500,queryLenghtMin:2,formSelector:"",tooltipSelector:"",overleySelector:""},i.extend(this.config,f),this.config.formSelector&&(t=i(this.config.formSelector)),this.config.tooltipSelector&&(c=i(this.config.tooltipSelector)),this.config.overleySelector&&(s=i(this.config.overleySelector)),this.timeout=null,this.run=function(){t.on("change",".pas-nav-left .pas-search-dropdown",function(){var o=i.trim(i(this).find("option:selected").text());t.find(".pas-nav-left .pas-search-label").text(o)}),t.find(".pas-nav-center .pas-input-text").on("keyup",function(){var o=this.value,a=t.find(".pas-nav-left .pas-search-dropdown").val();this.timeout&&clearTimeout(this.timeout),o.length>=e.config.queryLenghtMin?this.timeout=setTimeout(function(){e._find(o,a)},e.config.delay):e._hide()}).on("blur",function(){setTimeout(function(){e._hide()},500)})},this._find=function(o,a){t.find(".pas-loader").css("visibility","visible"),i.post(e.config.path,{q:o,cat:a},function(n){n=JSON.parse(i.trim(n)),n.q==t.find(".pas-nav-center .pas-input-text").val()&&(n.success&&n.content?(c.html(n.content),e._show()):e._hide())}).always(function(){t.find(".pas-loader").css("visibility","hidden")}).fail(function(){})},this._show=function(){t.addClass("pas-active"),s.addClass("show")},this._hide=function(){t.removeClass("pas-active"),s.removeClass("show")}}return l});
