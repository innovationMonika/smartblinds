define(["jquery","underscore","Magento_Catalog/js/price-utils"],function(t,h,f){"use strict";var v=t(window),u={processSwatchLabel:function(l){var e=l.parents("select"),d=f.findOptionId(e),i=t("#select_"+d+" option");if(!i)return;var r=e.parents(".field").find("label");r.parent().find("span#value").length<=0&&r.after('<span id="value"></span>');let p=t('.product-option-header label[for="select_'+d+'"]').parent().parent();p.find(".control .mage-error").length>0&&p.find(".control .mage-error").remove();var a=[],s=!1,o=-1;e.val()&&t(i).each(function(){if(Array.isArray(e.val())&&(o=t.inArray(t(this).attr("value"),e.val())),o!==-1||e.val()===t(this).attr("value")){s=!0;var c=t("[data-option-type-id='"+t(this).attr("value")+"']");c.addClass("selected"),c.attr("data-option-price")>0?a.push(t(this).text()):a.push(c.attr("data-option-label"))}});var n=r.parent().find("span#value");s===!1?n.html(""):n.html(a.join(", "))},_onClick:function(l){var e=t(l);if(!e.hasClass("disabled")){var d=this,i=e.attr("data-option-id"),r=e.attr("data-option-type-id"),p=e.attr("data-option-type"),a=t("#select_"+i),s=t("#select_"+i+" option");!s||(e.parents(".field").find("label").parent().find("span#value").length<=0&&e.parents(".field").find("label").after('<span id="value"></span>'),t(s).each(function(){if(!(t(this).val()!=r||e.hasClass("selected"))){if(p==="multiple")if(!a.val())a.val(r);else{var o=a.val();o.push(r),a.val(o)}else{a.val(r);var n=e.parents(".field").find("label").parent().find("span#value");n.html(e.attr("data-option-label")),e.attr("data-option-price")>0&&n.html(n.html()+" +"+f.formatPrice(e.attr("data-option-price"))),e.parent().parent().find(".selected").removeClass("selected")}e.addClass("selected"),a.trigger("change")}}),v.trigger("options-click",e))}}};return function(l){return t.widget("mageworx.optionSwatches",l,u),t.mageworx.optionSwatches}});
