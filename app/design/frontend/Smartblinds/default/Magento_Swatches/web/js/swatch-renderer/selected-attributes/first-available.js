define(["underscore"],function(r){"use strict";function v(i){for(var o=r.keys(i).length,n=r.values(i),e=[],t=o-1;t>=0;t--){var c=n[t],a=r.map(c.options,function(u){return[c.code,u.id]});if(t===o-1){e=r.map(a,function(u){return[u]});continue}var f=[];r.each(a,function(u){var p=r.map(e,function(h){var d=Array.from(h);return d.push(u),d});f=r.union(f,p)}),e=f}return r.map(e,function(u){return r.object(u)})}function s(i,o){var n=void 0;return r.each(o,function(e,t){var c=r.findWhere(i,{code:t}),a=c?r.findWhere(c.options,{id:e}):void 0;r.isUndefined(n)?n=a.products:n=r.intersection(n,a.products)}),Boolean(n.length)}return function(i){for(var o=v(i),n=0;n<o.length;n++){var e=o[n];if(s(i,e)){var t=1;return e}}return[]}});
