define(["jquery","underscore","Magento_Catalog/js/price-utils","mage/template","getSwatchSelectedProductId","Smartblinds_Options/js/model/price-calculator"],function(n,u,s,p,g,w){"use strict";const m=n(window);var h={options:{initialPriceTemplate:'<span class="price"><%- data.formatted %></span><% if (data?.oldPrice) { %><br/><span class="old-price"><%- data.oldPrice.formatted %></span><% } %>'},_init:function(){this._super(),m.on("optionBaseProcessApplyChanges",this.processApplyChanges.bind(this))},setProductFinalPrice:function(t){var i=this.options,o=i.priceFormat,e=(window==null?void 0:window.curtainTracks)?i.priceTemplate:i.initialPriceTemplate,r=n(i.productPriceInfoSelector).find('[data-price-type="finalPrice"]'),a={};if(u.isUndefined(r)||(t<0&&(t=0),!t))return;e=p(e),a.data={value:t,formatted:s.formatPrice(t,o)};let c=f();if(!(window==null?void 0:window.curtainTracks)){let P=n(".mageworx-swatch-container .mageworx-swatch-option");if(P.length>0){var T=this;P.each(function(){let l=n(this);if(!l.hasClass("selected"))return;let d=l.attr("data-option-price");!d||(d=parseFloat(d),l.data("option-code")===window.jsonConfig.bedieningOptionCode?c+=T.getBedieningOptionRegularPrice(l,d):c+=d)})}}c&&t<c&&(a.data.oldPrice={value:c,formatted:s.formatPrice(c,o)}),r.html(e(a)),n("[id=product-addtocart-button]").attr("data-price",t).data("price",t),n("[data-role=smartblinds-price]").show()},getBedieningOptionRegularPrice:function(t,i){const o=Object.values(window.jsonConfig.attributes).find(e=>e.code==="system_type").id;return n('.swatch-attribute[data-attribute-id="'+o+'"]').find('.swatch-option.selected[data-option-id="'+window.jsonConfig.systemTypeTdbuOptionId+'"]').length>0&&(i*=2),i},setAdditionalProductFinalPrice:function(t){},setProductPriceExclTax:function(t){},setAdditionalProductPriceExclTax:function(t){},setProductRegularPrice:function(t){(window==null?void 0:window.curtainTracks)||(t=f());var i=this.options,o=i.priceFormat,e=i.priceTemplate,r=n(i.productPriceInfoSelector).find('[data-price-type="oldPrice"]'),a={};u.isUndefined(r)||(t<0&&(t=0),!!t&&(e=p(e),a.data={value:t,formatted:s.formatPrice(t,o)},r.html(e(a))))},setAdditionalProductRegularPrice:function(t){}};function f(){let t=null;if(window==null?void 0:window.curtainTracks)return t=w.calculateCurtainTracksRegularPrice(),t||window.curtainTracks.regularPrice;if(t=w.calculateWidthHeightRegularPrice(),t)return t;let i=g(),o=window.jsonConfig,e=(o==null?void 0:o.optionPrices)?o.optionPrices:{},r=e.hasOwnProperty(i)?e[i]:null;return r?r.oldPrice.amount:null}return function(t){return n.widget("mageworx.optionBase",t,h),n.mageworx.optionBase}});
