define(["jquery","underscore","sampleBasket","getSwatchSelectedProductId"],function(a,l,c,w){"use strict";var I=a(window),t={selectors:{swatchOptions:'div[data-role="swatch-options"]',swatchInput:".swatch-input",sampleClick:".js-sample-click",sampleState:".js-sample-state"}},d=null,n,o,h,r;function v(){if(I.on("sample-basket-updated",p),n=a(t.selectors.swatchOptions),!!n.length){if(o=n.find(t.selectors.swatchInput),!o.length){n.on("swatch.initialized",u);return}u()}}function u(){o=n.find(t.selectors.swatchInput),o.on("change",m),h=a(t.selectors.sampleClick),h.on("click",k),r=a(t.selectors.sampleState),m()}function m(e){var s=parseInt(w());s&&(d=s,p())}function k(){var e=l.findWhere(t.options.items,{id:d});if(e){if(c.getItemBySwatches(e)){c.removeItemBySwatches(e);return}try{var s=null;e.parentId&&(s=l.findWhere(t.options.items,{id:e.parentId})),c.addItem(e,s)}catch(i){alert(i)}p()}}function p(e){var s=l.findWhere(t.options.items,{id:d});if(s&&c.getItemBySwatches(s)){r.html('<span class="tick-icon">'+t.options.addedToCartIcon+"</span>"),r.parents(t.selectors.sampleClick).addClass("active");return}r.each(function(){var i=a(this),f="";i.data("hide-add-button")||(f=t.options.addToCartIcon),i.html(f),i.parents(t.selectors.sampleClick).removeClass("active")})}return function(e){t.options=e,v()}});
