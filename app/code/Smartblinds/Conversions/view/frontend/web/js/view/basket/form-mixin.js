define(["jquery","underscore","knockout"],function(o,c,r){"use strict";return function(a){return a.extend({getConversionParam:function(e){let t=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return t&&decodeURIComponent(t[1].replace(/\+/g," "))},getExpiryRecord:function(e){let t=90*24*60*60*1e3,n=new Date().getTime()+t;return{value:e,expiryDate:n}},addGclid:function(){let e=null,t=this.getConversionParam("gclid"),n=this.getConversionParam("gclsrc"),l=!n||n.indexOf("aw")!==-1;t&&l&&(e=this.getExpiryRecord(t),localStorage.setItem("gclid",JSON.stringify(e)));let i=e||JSON.parse(localStorage.getItem("gclid"));return i&&new Date().getTime()<i.expiryDate?i==null?void 0:i.value:null},addFbp:function(){return o.cookie("_fbp")===void 0?null:o.cookie("_fbp")},addFbc:function(){let e=this.getConversionParam("fbclid");return e?(o.cookie("_fbc",e),e):o.cookie("_fbc")===void 0?null:o.cookie("_fbc")},setFormData:function(e){var t,n,l;this._super(),this.formData.gclid=r.observable((t=this.addGclid())!=null?t:null),this.formData.fbp=r.observable((n=this.addFbp())!=null?n:null),this.formData.fbc=r.observable((l=this.addFbc())!=null?l:null)}})}});
