define(["ko","jquery","underscore","Magento_Checkout/js/model/quote","Magento_Checkout/js/model/resource-url-manager","MageWorx_MultiFees/js/model/fee","Magento_Checkout/js/model/error-processor","MageWorx_MultiFees/js/model/fee-messages","mage/storage","mage/translate","Magento_Checkout/js/action/get-payment-information","Magento_Checkout/js/model/totals","Magento_Checkout/js/model/step-navigator","Magento_Checkout/js/model/cart/totals-processor/default"],function(j,a,u,o,_,g,k,t,C,n,f,s,l,d){"use strict";return function(m,r,y){var p=n("Fees were successfully applied."),i=n("Could not apply additional fee(s)");a.ajax({url:g.allData().url,data:m,type:"post",dataType:"json"}).done(function(e){e?e.reload?location.reload():(M(),t.addSuccessMessage({message:p})):(r(!1),s.isLoading(!1),t.addErrorMessage({message:i}))}).fail(function(e){r(!1),s.isLoading(!1),t.addErrorMessage({message:i})});function M(){if(r(!1),u.isEmpty(l.steps())){try{require(["Magento_Checkout/js/model/cart/cache","Magento_Checkout/js/model/cart/totals-processor/default"],function(c,h){c.clear("cartVersion"),h.estimateTotals(o.shippingAddress())})}catch{d.estimateTotals(o.shippingAddress())}require.defined("Magento_Checkout/js/model/cart/cache")||d.estimateTotals(o.shippingAddress())}if(l.getActiveItemIndex()){var e=a.Deferred();s.isLoading(!0),f(e),a.when(e).done(function(){s.isLoading(!1)})}}}});
