define(["ko","jquery","underscore","Magento_Checkout/js/model/quote","Magento_Checkout/js/model/resource-url-manager","MageWorx_MultiFees/js/model/product-fee","Magento_Checkout/js/model/error-processor","MageWorx_MultiFees/js/model/fee-messages","mage/storage","mage/translate","Magento_Checkout/js/action/get-payment-information","Magento_Checkout/js/model/totals","Magento_Checkout/js/model/step-navigator","Magento_Checkout/js/model/cart/totals-processor/default"],function(j,o,d,a,M,c,_,u,k,r,g,t,n,i){"use strict";return function(f,s,C){var y=r("Fees were successfully applied."),m=r("Could not apply additional fee(s)"),T=this;o.ajax({url:c.allData().url,data:f,type:"post",dataType:"json"}).done(function(e){e?e.reload?location.reload():p():(s(!1),t.isLoading(!1))}).fail(function(e){s(!1),t.isLoading(!1),u.addErrorMessage({message:m})});function p(){if(s(!1),d.isEmpty(n.steps())){try{require(["Magento_Checkout/js/model/cart/cache","Magento_Checkout/js/model/cart/totals-processor/default"],function(l,h){l.clear("cartVersion"),h.estimateTotals(a.shippingAddress())})}catch{i.estimateTotals(a.shippingAddress())}require.defined("Magento_Checkout/js/model/cart/cache")||i.estimateTotals(a.shippingAddress())}if(n.getActiveItemIndex()){var e=o.Deferred();t.isLoading(!0),g(e),o.when(e).done(function(){t.isLoading(!1)})}}}});
